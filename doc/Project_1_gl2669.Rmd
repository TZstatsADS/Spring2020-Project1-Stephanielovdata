---
title: "Project_1_gl2669"
Author: "Guoying Li"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### Step 0 - Load all the required libraries

```{r echo=FALSE,message=FALSE,warning=FALSE}
library(tm)
library(data.table)
library(tidytext)
library(tidyverse)
library(DT)
```

### Step 1 - Load the data to be cleaned and processed

```{r echo=FALSE,message=FALSE,warning=FALSE}
# load lyrics data
load('../data/lyrics.RData') 
lyrics <- dt_lyrics
head(lyrics)
```

### Step 2 - stemming words

```{r echo=FALSE,message=FALSE,warning=FALSE}

original_lyrics <- lyrics %>% 
  group_by(artist) %>%
  mutate(linenumber = row_number()) %>%
  ungroup()

tidy_lyrics <- original_lyrics %>% 
  unnest_tokens(word, lyrics)
tidy_lyrics
```

### stop words
```{r echo=FALSE,message=FALSE,warning=FALSE}
data("stop_words")
tidy_lyrics <- tidy_lyrics  %>%
  anti_join(stop_words)
tidy_lyrics
```

### count and find the most common words in all the lyrics as a whole

```{r echo=FALSE,message=FALSE,warning=FALSE}
tidy_lyrics %>%
  group_by(genre) %>%
  count(word, sort = TRUE)
```

### ggplot and create a visualization of the most common words
rock lyrics plot 
rock: love, time, yeah, baby, gonna, feel, life, day. night, world, heart

```{r echo=FALSE,message=FALSE,warning=FALSE}
library(ggplot2)

rock_lyrics_most_frequencies_plot <- tidy_lyrics %>%
  group_by(genre) %>%
  count(word, sort = TRUE) %>%
  filter(genre == "Rock") %>%
  filter(n > 20000) %>%
  mutate(word = reorder(word, n)) %>%
  ggplot(aes(word,n, color = word, fill = word)) +
  geom_col() +
  labs(title = "Top Frequencies Words of Rock") +
  coord_flip() +
  theme_light() +
  theme(plot.title = element_text(hjust = 0.5), plot.subtitle = element_text(hjust= 0.5))

rock_lyrics_most_frequencies_plot 
```

### pop lyrics ggplot
pop: love, baby, time, yeah, heart, feel, gonna, life, wanna

```{r echo=FALSE,message=FALSE,warning=FALSE}
pop_lyrics_most_frequencies_plot <- tidy_lyrics %>%
  group_by(genre) %>%
  count(word, sort = TRUE) %>%
  filter(genre == "Pop") %>%
  filter(n > 10000) %>%
  mutate(word = reorder(word, n)) %>%
  ggplot(aes(word,n, color = word, fill = word)) +
  geom_col() +
  labs(title = "Top Frequencies Words of Pop") +
  coord_flip() +
  theme_light() +
  theme(plot.title = element_text(hjust = 0.5), plot.subtitle = element_text(hjust= 0.5))

pop_lyrics_most_frequencies_plot
```

### Hip-Hop lyrics plot
Hip-Hop: nigga, love, yeah, shit, ya, yo, time, baby, fuck, em, niggas

```{r echo=FALSE,message=FALSE,warning=FALSE}
hiphop_lyrics_most_frequencies_plot <- tidy_lyrics %>%
  group_by(genre) %>%
  count(word, sort = TRUE) %>%
  filter(genre == "Hip-Hop") %>%
  filter(n > 10000) %>%
  mutate(word = reorder(word, n)) %>%
  ggplot(aes(word,n, color = word, fill = word)) +
  geom_col() +
  labs(title = "Top Frequencies Words of Hip-Hop") +
  coord_flip() +
  theme_light() +
  theme(plot.title = element_text(hjust = 0.5), plot.subtitle = element_text(hjust= 0.5))
hiphop_lyrics_most_frequencies_plot
```
### Country lyrics plot
Country: love, time, heart, gonna, baby, night, day, home, yeah, life

```{r echo=FALSE,message=FALSE,warning=FALSE}
country_lyrics_most_frequencies_plot <- tidy_lyrics %>%
  group_by(genre) %>%
  count(word, sort = TRUE) %>%
  filter(genre == "Country") %>%
  filter(n > 2500) %>%
  mutate(word = reorder(word, n)) %>%
  ggplot(aes(word,n, color = word, fill = word)) +
  geom_col() +
  labs(title = "Top Frequencies Words of Country") +
  coord_flip() +
  theme_light() +
  theme(plot.title = element_text(hjust = 0.5), plot.subtitle = element_text(hjust= 0.5))
country_lyrics_most_frequencies_plot
```

### Metal lyrics plot
Metal: life, time, world, eyes, love, feel, blood, death, pain, dies
```{r echo=FALSE,message=FALSE,warning=FALSE}
metal_lyrics_most_frequencies_plot <- tidy_lyrics %>%
  group_by(genre) %>%
  count(word, sort = TRUE) %>%
  filter(genre == "Metal") %>%
  filter(n > 3500) %>%
  mutate(word = reorder(word, n)) %>%
  ggplot(aes(word,n, color = word, fill = word)) +
  geom_col() +
  labs(title = "Top Frequencies Words of Metal") +
  coord_flip() +
  theme_light() +
  theme(plot.title = element_text(hjust = 0.5), plot.subtitle = element_text(hjust= 0.5))
metal_lyrics_most_frequencies_plot
```

###
```{r echo=FALSE,message=FALSE,warning=FALSE}
levels(factor(tidy_lyrics$genre) )
```

### Electronic lyrics plot
Electronic: love, feel, time, yeah, world, baby, night, life, gonna, wanna
```{r echo=FALSE,message=FALSE,warning=FALSE}
electronic_lyrics_most_frequencies_plot <- tidy_lyrics %>%
  group_by(genre) %>%
  count(word, sort = TRUE) %>%
  filter(genre == "Electronic") %>%
  filter(n > 1000) %>%
  mutate(word = reorder(word, n)) %>%
  ggplot(aes(word,n, color = word, fill = word)) +
  geom_col() +
  labs(title = "Top Frequencies Words of Electronic") +
  coord_flip() +
  theme_light() +
  theme(plot.title = element_text(hjust = 0.5), plot.subtitle = element_text(hjust= 0.5))

electronic_lyrics_most_frequencies_plot
```

### Jazz lyrics plot
Jazz: love, baby, heart, time, day, night, gonna, life, feel
```{r echo=FALSE,message=FALSE,warning=FALSE}
jazz_lyrics_most_frequencies_plot <- tidy_lyrics %>%
  group_by(genre) %>%
  count(word, sort = TRUE) %>%
  filter(genre == "Jazz") %>%
  filter(n > 1030) %>%
  mutate(word = reorder(word, n)) %>%
  ggplot(aes(word,n, color = word, fill = word)) +
  geom_col() +
  labs(title = "Top Frequencies Words of Jazz") +
  coord_flip() +
  theme_light() +
  theme(plot.title = element_text(hjust = 0.5), plot.subtitle = element_text(hjust= 0.5))
jazz_lyrics_most_frequencies_plot
```

### R&B lyrics plot
R&B: love, baby, yeah, time, girl, gonna, heart, feel, day, life, wanna
```{r echo=FALSE,message=FALSE,warning=FALSE}
rb_lyrics_most_frequencies_plot <- tidy_lyrics %>%
  group_by(genre) %>%
  count(word, sort = TRUE) %>%
  filter(genre == "R&B") %>%
  filter(n > 1000) %>%
  mutate(word = reorder(word, n)) %>%
  ggplot(aes(word,n, color = word, fill = word)) +
  geom_col() +
  labs(title = "Top Frequencies Words of R&B") +
  coord_flip() +
  theme_light() +
  theme(plot.title = element_text(hjust = 0.5), plot.subtitle = element_text(hjust= 0.5))
rb_lyrics_most_frequencies_plot
```

### Indie lyrics plot
Indie: love, time, home, heart, feel, gonna, life, eyes, day, mind

```{r echo=FALSE,message=FALSE,warning=FALSE}
indie_lyrics_most_frequencies_plot <- tidy_lyrics %>%
  group_by(genre) %>%
  count(word, sort = TRUE) %>%
  filter(genre == "Indie") %>%
  filter(n > 400) %>%
  mutate(word = reorder(word, n)) %>%
  ggplot(aes(word,n, color = word, fill = word)) +
  geom_col() +
  labs(title = "Top Frequencies Words of Indie") +
  coord_flip() +
  theme_light() +
  theme(plot.title = element_text(hjust = 0.5), plot.subtitle = element_text(hjust= 0.5))

indie_lyrics_most_frequencies_plot
```

### Folk lyrics plot
Folk: love, time, day, yeah, gonna, home, night, world, hear, life, heart, baby, sea

```{r echo=FALSE,message=FALSE,warning=FALSE}
folk_lyrics_most_frequencies_plot <- tidy_lyrics %>%
  group_by(genre) %>%
  count(word, sort = TRUE) %>%
  filter(genre == "Folk") %>%
  filter(n > 120) %>%
  mutate(word = reorder(word, n)) %>%
  ggplot(aes(word,n, color = word, fill = word)) +
  geom_col() +
  labs(title = "Top Frequencies Words of Folk") +
  coord_flip() +
  theme_light() +
  theme(plot.title = element_text(hjust = 0.5), plot.subtitle = element_text(hjust= 0.5))

folk_lyrics_most_frequencies_plot
```

### Summary of 12 types of lyrics
###Rock, Pop and Hip-Hop are the three largest lyrics. 
###Feeling is for most artists who want to deliver from the songs. (key word: feel)
###Inspiration is always from the lives of the artists. (key word: life)
###Love is the main theme for most of the lyrics excerpt for the Metal (Love)
###Not only Hip-Hop but also other lyrics like to use rhyme words such as "Yeah"
Top Frequencies words based on the lyrics: 

Category 1: Positive
common words: love, time, yeah, life, world, wanna, gonna, day, night, feel 

rock: love, time, yeah, baby, gonna, feel, life, day. night, world, heart
pop: love, baby, time, yeah, heart, feel, gonna, life, wanna
Country: love, time, heart, gonna, baby, night, day, home, yeah, life
Electronic: love, feel, time, yeah, world, baby, night, life, gonna, wanna
Jazz: love, baby, heart, time, day, night, gonna, life, feel
Indie: love, time, home, heart, feel, gonna, life, eyes, day, mind
Folk: love, time, day, yeah, gonna, home, night, world, hear, life, heart, baby, sea

Category 2: Rhyme
R&B: love, baby, yeah, time, girl, gonna, heart, feel, day, life, wanna
Hip-Hop: nigga, love, yeah, shit, ya, yo, time, baby, fuck, em, niggas

Category 3: Negative
Metal: life, time, world, eyes, love, feel, blood, death, pain, dies

Rock, pop, country, electronic, Jazz, Indie and Folk songs are about love and other positive feelings. Some artists talk about home, world and life (day and night) while others talk about the people they are in love with. 

Hip-Hop are usually about love stories and include rhyme like ya, yo, em. 

Metal is the only one which has many negative words (death, blood) as top frequencies words. 

### References
https://www.tidytextmining.com/tidytext.html

### summary plot

```{r}
# still need to learn how to use td idf 

tidy_lyrics %>%
  group_by(genre) %>%
  count(word, sort = TRUE) %>%
  top_n(10) %>% 
  ungroup() %>%  
  mutate(word = reorder(word, n)) %>%
  ggplot(aes(word,n, color = word, fill = word)) +
  geom_col(show.legend = FALSE) +
  facet_wrap(~genre, ncol = 3, scales = "free") +
  coord_flip() +
  labs(title = "Top Frequencies Words of Folk") +
  theme_light() +
  theme(plot.title = element_text(hjust = 0.5), plot.subtitle = element_text(hjust= 0.5))
```


### WordCloud

```{r}
library(wordcloud)

tidy_lyrics %>%
  anti_join(stop_words) %>%
  count(word) %>%
  with(wordcloud(word, n, max.words = 100))
```
### positive vs negative wordcloud

```{r}
library(reshape2)

tidy_lyrics %>%
  inner_join(get_sentiments("bing")) %>%
  count(word, sentiment, sort = TRUE) %>%
  acast(word ~ sentiment, value.var = "n", fill = 0) %>%
  comparison.cloud(colors = c("gray20", "gray80"),
                   max.words = 100)
```

