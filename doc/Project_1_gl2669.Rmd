---
title: "Project_1_gl2669"
Author: "Guoying Li"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### Step 0 - Load all the required libraries

```{r echo=FALSE,message=FALSE,warning=FALSE}
library(tm)
library(data.table)
library(tidytext)
library(tidyverse)
library(DT)
```

### Step 1 - Load the data to be cleaned and processed

```{r echo=FALSE,message=FALSE,warning=FALSE}
# load lyrics data
load('../data/lyrics.RData') 
lyrics <- dt_lyrics
head(lyrics)
```

### Step 2 - stemming words

```{r echo=FALSE,message=FALSE,warning=FALSE}

original_lyrics <- lyrics %>% 
  group_by(artist) %>%
  mutate(linenumber = row_number()) %>%
  ungroup()

tidy_lyrics <- original_lyrics %>% 
  unnest_tokens(word, lyrics)
tidy_lyrics
```

### stop words
```{r echo=FALSE,message=FALSE,warning=FALSE}
data("stop_words")
tidy_lyrics <- tidy_lyrics  %>%
  anti_join(stop_words)
tidy_lyrics
```

### count and find the most common words in all the lyrics as a whole

```{r echo=FALSE,message=FALSE,warning=FALSE}
tidy_lyrics %>%
  group_by(genre) %>%
  count(word, sort = TRUE)
```

###
```{r echo=FALSE,message=FALSE,warning=FALSE}
levels(factor(tidy_lyrics$genre) )
```

### WordCloud

```{r echo=FALSE,message=FALSE,warning=FALSE}
library(wordcloud)

tidy_lyrics %>%
  anti_join(stop_words) %>%
  count(word) %>%
  with(wordcloud(word, n, max.words = 100))
```

### positive vs negative wordcloud

```{r echo=FALSE,message=FALSE,warning=FALSE}
library(reshape2)

tidy_lyrics %>%
  inner_join(get_sentiments("bing")) %>%
  count(word, sentiment, sort = TRUE) %>%
  acast(word ~ sentiment, value.var = "n", fill = 0) %>%
  comparison.cloud(colors = c("gray20", "gray80"),
                   max.words = 100)
```

### summary plot


```{r echo=FALSE,message=FALSE,warning=FALSE}
tidy_lyrics %>%
  filter(genre != "Not Available" & genre != "Other") %>%
  group_by(genre) %>%
  count(word, sort = TRUE) %>%
  top_n(10) %>% 
  ungroup() %>%
  mutate(word = reorder(word, n)) %>%
  ggplot(aes(word,n, color = word, fill = word)) +
  geom_col(show.legend = FALSE) +
  facet_wrap(~genre, ncol = 3, scales = "free") +
  coord_flip() +
  labs(y = "n") +
  theme_light() +
  theme(plot.title = element_text(hjust = 0.5), plot.subtitle = element_text(hjust= 0.5))

```



### tf-idf 
```{r echo=FALSE,message=FALSE,warning=FALSE}
# still need to learn how to use td idf 
lyrics_by_genre <- tidy_lyrics %>%
  group_by(genre) %>%
  count(genre, word, sort = TRUE)

tf_idf <- lyrics_by_genre %>%
  bind_tf_idf(word, genre, n) %>%
  arrange(desc(tf_idf))


tf_idf

```

# plot after tf-idf

```{r echo=FALSE,message=FALSE,warning=FALSE}

tf_idf %>%
  filter(genre != "Not Available" & genre != "Other") %>%
  group_by(genre) %>%
  top_n(10, tf_idf) %>% 
  ungroup() %>%  
  mutate(word = reorder(word, tf_idf)) %>%
  ggplot(aes(word,tf_idf,fill = genre)) +
  geom_col(show.legend = FALSE) +
  facet_wrap(~genre, ncol = 3, scales = "free") +
  coord_flip() +
  labs(y = "tf-idf") +
  theme_light() +
  theme(plot.title = element_text(hjust = 0.5), plot.subtitle = element_text(hjust= 0.5))

```

### Summary of 12 types of lyrics
###Rock, Pop and Hip-Hop are the three largest lyrics. 
###Feeling is for most artists who want to deliver from the songs. (key word: feel)
###Inspiration is always from the lives of the artists. (key word: life)
###Love is the main theme for most of the lyrics excerpt for the Metal (Love)
###Not only Hip-Hop but also other lyrics like to use rhyme words such as "Yeah"
Top Frequencies words based on the lyrics: 

Category 1: Positive
common words: love, time, yeah, life, world, wanna, gonna, day, night, feel 

rock: love, time, yeah, baby, gonna, feel, life, day. night, world, heart
pop: love, baby, time, yeah, heart, feel, gonna, life, wanna
Country: love, time, heart, gonna, baby, night, day, home, yeah, life
Electronic: love, feel, time, yeah, world, baby, night, life, gonna, wanna
Jazz: love, baby, heart, time, day, night, gonna, life, feel
Indie: love, time, home, heart, feel, gonna, life, eyes, day, mind
Folk: love, time, day, yeah, gonna, home, night, world, hear, life, heart, baby, sea

Category 2: Rhyme
R&B: love, baby, yeah, time, girl, gonna, heart, feel, day, life, wanna
Hip-Hop: nigga, love, yeah, shit, ya, yo, time, baby, fuck, em, niggas

Category 3: Negative
Metal: life, time, world, eyes, love, feel, blood, death, pain, dies

Rock, pop, country, electronic, Jazz, Indie and Folk songs are about love and other positive feelings. Some artists talk about home, world and life (day and night) while others talk about the people they are in love with. 

Hip-Hop are usually about love stories and include rhyme like ya, yo, em. 

Metal is the only one which has many negative words (death, blood) as top frequencies words. 

### References
https://www.tidytextmining.com/tidytext.html





